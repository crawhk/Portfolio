---
title: "Portfolio 6 - Thesis Moderation"
---

> For my thesis, I conducted a multi-level moderation. I originally did all of my anaylses in SPSS. However, I could not graph it correctly in SPSS. The goal here is to attempt (I am unsure of the success of this venture) to run this analysis and graph it in R. 

```{r}
library(haven)
library(tidyr)
library(tidyverse)
```

```{r}
ThesisMod <- read_spss("C:/Users/crawl/OneDrive - Wake Forest University/GitHub/Portfolio/DT Lie Scenario Data.sav")
```

```{r}
library(lme4)
library(lmerTest)
```

```{r}

model <- lmer(LieAvg ~ DTTotalC * Scenario 
              + (1 | Person), data = ThesisMod)
summary(model)

```
I got the same results in SPSS for my thesis! That was expected, now I would like to graph this... which would have come in handy weeks ago, but we were limited on time. 


```{r}
library(ggeffects)
library(ggplot2)
```

```{R}
# Generate predicted values from model
pred <- ggpredict(model, terms = c("DTTotalC", "Scenario"))
```

```{r}
ggplot(pred, aes(x = x, y = predicted, color = group)) +
  geom_line(size = 1) +
  labs(x = "Dark Triad", 
       y = "Predicted Lying", 
       color = "Scenario", 
       fill = "Scenario", 
       title = "DTâ€“Lying Relationship Moderated by Scenario")
```
These lines look to be relatively parallel, though not perfect. I am curious as to if a sample had very high levels of DT traits if this moderation would be different. 









